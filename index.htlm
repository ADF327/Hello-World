<!DOCTYPE html>
<html>
<head>
    <title>V1</title>
    <style>
        #mindmap-container {
            width: 100%;
            height: 600px;
            border: 1px solid #ccc;
            position: relative;
        }
        .node {
            position: absolute;
            padding: 10px;
            border: 2px solid #3498db;
            border-radius: 5px;
            background-color: white;
            cursor: move;
            min-width: 100px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div id="mindmap-container"></div>
    <button onclick="addNode()">AÃ±adir Nodo</button>
    <button onclick="saveMindMap()">Save</button>

    <script>
        let nodes = [];
        let selectedNode = null;
        
        function addNode() {
            const newNode = {
                id: Date.now(),
                title: "New Node",
                x: 100,
                y: 100,
                connections: []
            };
            nodes.push(newNode);
            renderNode(newNode);
        }
        
        function renderNode(node) {
            const nodeElement = document.createElement('div');
            nodeElement.className = 'node';
            nodeElement.id = 'node-' + node.id;
            nodeElement.style.left = node.x + 'px';
            nodeElement.style.top = node.y + 'px';
            nodeElement.innerHTML = node.title;
            
            nodeElement.addEventListener('click', () => {
                selectedNode = node;
            });
            
            document.getElementById('mindmap-container').appendChild(nodeElement);
        }
        
        function saveMindMap() {
            // Enviar datos al backend
            fetch('/api/mindmap', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    title: 'Mi Mapa Mental',
                    nodes: nodes,
                    userId: 1
                })
            })
            .then(response => response.json())
            .then(data => {
                console.log('Mapa guardado:', data);
            });
        }
        
        // Cargar mapa existente al iniciar
        window.onload = function() {
            const urlParams = new URLSearchParams(window.location.search);
            const mapId = urlParams.get('id');
            if (mapId) {
                loadMindMap(mapId);
            }
        };
        
        function loadMindMap(mapId) {
            fetch('/api/mindmap/' + mapId)
                .then(response => response.json())
                .then(data => {
                    nodes = data.nodes;
                    nodes.forEach(node => renderNode(node));
                });
        }
    </script>
</body>
</html>
